\chapter{IEC Serial Port}

The \jr\ has an IEC serial port included (this is the Commodore serial port variation of the IEEE-488 interface). There are two registers supporting the IEC port. There is a read-only register that shows the current state of the individual lines on the serial bus, and there is a read/write register that can be used to control the various lines as well as how IEC interrupts are handled.

\begin{table}[h]
    \begin{center}
        \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|} \hline
            Address & R/W & Name & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\\hline\hline
            \verb+0xD680+ & R & IEC\_I & SRQ\_i & \multicolumn{2}{|c|}{---} & ATN\_i & \multicolumn{2}{|c|}{---} & CLK\_i & DAT\_i \\ \hline
            \verb+0xD681+ & R/W & IEC\_O & SRQ\_o & RST\_o & NMI\_EN & ATN\_o & \multicolumn{2}{|c|}{---} & CLK\_o & DAT\_o \\ \hline
        \end{tabular}
    \end{center}
    \caption{IEC Registers}
    \label{tab:iec_reg}
\end{table}

\begin{description}
    \item[DAT\_i] Reflects the current state of the DATA line on the IEC bus. 
    \item[CLK\_i] Reflects the current state of the CLK line on the IEC bus.
    \item[ATN\_i] Reflects the current state of the ATN line on the IEC bus.
    \item[SRQ\_i] Reflects the current state of the SREQ line on the IEC bus.
    
    \item[DAT\_o] Sets the DATA line on the IEC bus. 
    \item[CLK\_o] Sets the CLK line on the IEC bus.
    \item[ATN\_o] Sets the ATN line on the IEC bus.
    \item[SRQ\_o] Sets the SREQ line on the IEC bus.
    \item[RST\_o] Resets the IEC bus (and any installed SIDs on the \fjr).
    \item[NMI\_EN] If set (1), the IEC interrupts will trigger an NMI interrupt. If clear (0), the IEC interrupts will trigger an IRQ interrupt.  
\end{description}
